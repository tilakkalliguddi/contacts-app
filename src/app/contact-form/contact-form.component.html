<mat-card appearance="outlined" #contactFormModel>
    <mat-card-content>
        <mat-toolbar>
            <span>Contact Form</span>
            <span class="example-spacer"></span>
        </mat-toolbar>

        <form [formGroup]="contactForm" (ngSubmit)="SaveData()">
            <mat-form-field>
                <mat-label>Name</mat-label>
                <input matInput formControlName="name">
            </mat-form-field>

            <div formArrayName="emails">
                @for(email of this.contactForm.controls.emails.controls; track email; let i = $index ){
                <div [formGroupName]="i">

                    <mat-form-field class="label">
                        <mat-label>Label</mat-label>

                        
                        <mat-select formControlName="label" (selectionChange)="onMailLabelChange($event, i)">
                            @for (label of mailLabels; track label) {
                            <mat-option [value]="label.value">{{label.viewValue}}</mat-option>
                            }
                            <mat-option value="other">Other</mat-option>
                        </mat-select>
                    </mat-form-field>

                    @if(isOtherMailLabelSelected[i]){<mat-form-field class="label">
                        <mat-label>Custom Label</mat-label>
                        <input matInput formControlName="customMailLabel">
                    </mat-form-field>
                }

                    <mat-form-field class="phoneInp">
                        <mat-label>Email</mat-label>
                        <input matInput type="text" formControlName="email">
                        <div class="icons">
                            @if(i === emails.length - 1){
                            <mat-icon mat-icon-button (click)="addEmail()" matSuffix>add</mat-icon>
                            }
                            @if(emails.length > 1){
                            <mat-icon mat-icon-button (click)="removeEmail(i)" matSuffix>close</mat-icon>
                            }
                        </div>
                    </mat-form-field>
                </div>
                }
            </div>
            <div formArrayName="phoneNumbers">
                @for(phone of this.contactForm.controls.phoneNumbers.controls; track phone; let i = $index ){
                <div [formGroupName]="i">

                    <mat-form-field class="label">
                        <mat-label>Label</mat-label>
                        <mat-select formControlName="label" (selectionChange)="onPhoneLabelChange($event, i)">
                            @for (label of phoneLabels; track label) {
                            <mat-option [value]="label.value">{{label.viewValue}}</mat-option>
                            }
                            <mat-option value="other">Other</mat-option>
                        </mat-select>
                    </mat-form-field>
                    
                    @if(isOtherPhoneLabelSelected[i]){<mat-form-field>
                        <mat-label>Custom Label</mat-label>
                        <input matInput formControlName="customPhoneLabel" value="phoneNumbers[i].customLabel">
                    </mat-form-field>
                }

                    <mat-form-field class="phoneInp">
                        <mat-label>Phone</mat-label>
                        <input matInput type="number" formControlName="phoneNumber">
                        <div class="icons">
                            @if(i === phoneNumbers.length - 1){
                            <mat-icon mat-icon-button (click)="addPhoneNumber()" matSuffix>add</mat-icon>
                            }
                            @if(phoneNumbers.length > 1){
                            <mat-icon mat-icon-button (click)="removePhoneNumber(i)" matSuffix>close</mat-icon>
                            }
                        </div>
                    </mat-form-field>
                </div>
                }
            </div>
            <mat-form-field>
                <mat-label>Address</mat-label>
                <input matInput formControlName="address">
            </mat-form-field>
            <button mat-raised-button type="submit" [disabled]="this.contactForm.invalid">Submit</button>
        </form>
    </mat-card-content>
</mat-card>